# @package _global_
name: ttnet_sota_v5_final_single
notes: >-
  TTNet trained with single transformation data:
  1. Fusion context into label_ids,
  2. Use difference features
  3. Topic and category classification
  4. MTM

defaults:
  - override /model: ttnet_diff
  - override /model/generate_cfg: top_k_top_p_no_repeat
  - override /criterion: multitask
  - override /scheduler: linear_warmup

dataset:
  single_data: true

model:
  diff_mode: late
  context_mode: attention
  topic_head: true
  category_head: true
  image_encoder: ViT-L/14
  learned_mask: false
  mask_ratio: 0.15
  sample_mask_prob: 0.5
  zero_prob: 1.0
  random_prob: 0.0

criterion:
  loss:
    logit_shift: 0
    label_shift: -1
    w_construct: null
    w_classify: 0.25
    w_category: 0.1
    w_topic: 1.
  topic: true
  category: true

pl_trainer:
  precision: 32
  max_epochs: 50
